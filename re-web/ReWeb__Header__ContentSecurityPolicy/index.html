<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>ReWeb__Header__ContentSecurityPolicy (re-web.ReWeb__Header__ContentSecurityPolicy)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">re-web</a> &#x00BB; ReWeb__Header__ContentSecurityPolicy</nav><h1>Module <code>ReWeb__Header__ContentSecurityPolicy</code></h1><p>Convenience module for creating a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">Content-Security-Policy</a> header. <i>Note</i> that to set up a reporting endpoint properly, you will need to use <a href="../ReWeb__Server/Filter/index.html#val-csp"><code>ReWeb.Filter.csp</code></a>.</p></header><dl><dt class="spec type" id="type-src"><a href="#type-src" class="anchor"></a><code><span class="keyword">type</span> src</code><code> = </code><table class="variant"><tr id="type-src.Host" class="anchored"><td class="def constructor"><a href="#type-src.Host" class="anchor"></a><code>| </code><code><span class="constructor">Host</span>(string)</code></td></tr><tr id="type-src.Scheme" class="anchored"><td class="def constructor"><a href="#type-src.Scheme" class="anchor"></a><code>| </code><code><span class="constructor">Scheme</span>(<span>[ `HTTP <span>| `HTTPS</span> <span>| `Data</span> <span>| `Mediastream</span> <span>| `Blob</span> <span>| `Filesystem</span> ]</span>)</code></td></tr><tr id="type-src.Self" class="anchored"><td class="def constructor"><a href="#type-src.Self" class="anchor"></a><code>| </code><code><span class="constructor">Self</span></code></td></tr><tr id="type-src.Unsafe_eval" class="anchored"><td class="def constructor"><a href="#type-src.Unsafe_eval" class="anchor"></a><code>| </code><code><span class="constructor">Unsafe_eval</span></code></td></tr><tr id="type-src.Unsafe_hashes" class="anchored"><td class="def constructor"><a href="#type-src.Unsafe_hashes" class="anchor"></a><code>| </code><code><span class="constructor">Unsafe_hashes</span></code></td></tr><tr id="type-src.Unsafe_inline" class="anchored"><td class="def constructor"><a href="#type-src.Unsafe_inline" class="anchor"></a><code>| </code><code><span class="constructor">Unsafe_inline</span></code></td></tr><tr id="type-src.None" class="anchored"><td class="def constructor"><a href="#type-src.None" class="anchor"></a><code>| </code><code><span class="constructor">None</span></code></td></tr><tr id="type-src.Nonce" class="anchored"><td class="def constructor"><a href="#type-src.Nonce" class="anchor"></a><code>| </code><code><span class="constructor">Nonce</span>(string)</code></td></tr><tr id="type-src.Hash" class="anchored"><td class="def constructor"><a href="#type-src.Hash" class="anchor"></a><code>| </code><code><span class="constructor">Hash</span>(<span>[ `SHA256 <span>| `SHA384</span> <span>| `SHA512</span> ]</span>, string)</code></td></tr></table>;</dt><dt class="spec type" id="type-src_list"><a href="#type-src_list" class="anchor"></a><code><span class="keyword">type</span> src_list</code><code> = option(list(<a href="index.html#type-src">src</a>))</code>;</dt><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = <span class="keyword">pri</span> </code><code>{</code><table class="record"><tr id="type-t.child_src" class="anchored"><td class="def field"><a href="#type-t.child_src" class="anchor"></a><code>child_src: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.connect_src" class="anchored"><td class="def field"><a href="#type-t.connect_src" class="anchor"></a><code>connect_src: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.default_src" class="anchored"><td class="def field"><a href="#type-t.default_src" class="anchor"></a><code>default_src: list(<a href="index.html#type-src">src</a>),</code></td></tr><tr id="type-t.font_src" class="anchored"><td class="def field"><a href="#type-t.font_src" class="anchor"></a><code>font_src: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.frame_src" class="anchored"><td class="def field"><a href="#type-t.frame_src" class="anchor"></a><code>frame_src: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.img_src" class="anchored"><td class="def field"><a href="#type-t.img_src" class="anchor"></a><code>img_src: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.manifest_src" class="anchored"><td class="def field"><a href="#type-t.manifest_src" class="anchor"></a><code>manifest_src: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.media_src" class="anchored"><td class="def field"><a href="#type-t.media_src" class="anchor"></a><code>media_src: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.object_src" class="anchored"><td class="def field"><a href="#type-t.object_src" class="anchor"></a><code>object_src: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.prefetch_src" class="anchored"><td class="def field"><a href="#type-t.prefetch_src" class="anchor"></a><code>prefetch_src: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.script_src" class="anchored"><td class="def field"><a href="#type-t.script_src" class="anchor"></a><code>script_src: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.script_src_elem" class="anchored"><td class="def field"><a href="#type-t.script_src_elem" class="anchor"></a><code>script_src_elem: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.script_src_attr" class="anchored"><td class="def field"><a href="#type-t.script_src_attr" class="anchor"></a><code>script_src_attr: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.style_src" class="anchored"><td class="def field"><a href="#type-t.style_src" class="anchor"></a><code>style_src: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.style_src_elem" class="anchored"><td class="def field"><a href="#type-t.style_src_elem" class="anchor"></a><code>style_src_elem: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.style_src_attr" class="anchored"><td class="def field"><a href="#type-t.style_src_attr" class="anchor"></a><code>style_src_attr: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.worker_src" class="anchored"><td class="def field"><a href="#type-t.worker_src" class="anchor"></a><code>worker_src: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.base_uri" class="anchored"><td class="def field"><a href="#type-t.base_uri" class="anchor"></a><code>base_uri: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.plugin_types" class="anchored"><td class="def field"><a href="#type-t.plugin_types" class="anchor"></a><code>plugin_types: option(list(string)),</code></td></tr><tr id="type-t.form_action" class="anchored"><td class="def field"><a href="#type-t.form_action" class="anchor"></a><code>form_action: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.navigate_to" class="anchored"><td class="def field"><a href="#type-t.navigate_to" class="anchor"></a><code>navigate_to: <a href="index.html#type-src_list">src_list</a>,</code></td></tr><tr id="type-t.report_to" class="anchored"><td class="def field"><a href="#type-t.report_to" class="anchor"></a><code>report_to: option(list(string)),</code></td></tr><tr id="type-t.block_all_mixed_content" class="anchored"><td class="def field"><a href="#type-t.block_all_mixed_content" class="anchor"></a><code>block_all_mixed_content: option(bool),</code></td></tr></table><code>}</code>;</dt><dd><p>CSP header value data model.</p></dd></dl><dl><dt class="spec value" id="val-has_report_to"><a href="#val-has_report_to" class="anchor"></a><code><span class="keyword">let</span> has_report_to: option(list(string)) <span>=&gt;</span> bool;</code></dt><dt class="spec value" id="val-make"><a href="#val-make" class="anchor"></a><code><span class="keyword">let</span> make: <span>?&#8288;child_src:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;connect_src:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;font_src:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;frame_src:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;img_src:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;manifest_src:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;media_src:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;object_src:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;prefetch_src:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;script_src:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;script_src_elem:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;script_src_attr:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;style_src:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;style_src_elem:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;style_src_attr:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;worker_src:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;base_uri:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;plugin_types:list(string)</span> <span>=&gt;</span> <span>?&#8288;form_action:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;navigate_to:list(<a href="index.html#type-src">src</a>)</span> <span>=&gt;</span> <span>?&#8288;report_to:list(string)</span> <span>=&gt;</span> <span>?&#8288;block_all_mixed_content:bool</span> <span>=&gt;</span> list(<a href="index.html#type-src">src</a>) <span>=&gt;</span> <a href="index.html#type-t">t</a>;</code></dt><dd><p><code>make(..., default_src)</code> is a content security policy consisting of the given options.</p></dd></dl><dl><dt class="spec value" id="val-report_to_header"><a href="#val-report_to_header" class="anchor"></a><code><span class="keyword">let</span> report_to_header: <a href="index.html#type-t">t</a> <span>=&gt;</span> <span>(string, string)</span>;</code></dt><dd><p><code>report_to_string(directives)</code> is a valid <code>Report-To</code> header using the <code>directives</code>.</p></dd></dl><dl><dt class="spec value" id="val-to_header"><a href="#val-to_header" class="anchor"></a><code><span class="keyword">let</span> to_header: <span>?&#8288;report_only:bool</span> <span>=&gt;</span> <a href="index.html#type-t">t</a> <span>=&gt;</span> <span>(string, string)</span>;</code></dt><dd><p><code>to_header(?report_only, directives)</code> is a either a <code>content-security-policy</code> header (if <code>report_only</code> is <code>false</code> which is the default), or a <code>content-security-policy-report-only</code> header if <code>report_only</code> is <code>true</code>.</p><p>If <code>directives</code> just contains empty lists, <code>to_header</code> will output the <code>default-src 'self'</code> directive under the assumption that you want some protection since you're trying to use CSP.</p><p>If <code>directives</code> contains a non-empty <code>report_to</code>, will output both <code>report-uri</code> and <code>report-to</code> directives to try to target browsers that support either.</p></dd></dl></div></body></html>