<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>ReWeb__Topic (re-web.ReWeb__Topic)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">re-web</a> &#x00BB; ReWeb__Topic</nav><h1>Module <code>ReWeb__Topic</code></h1></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t('a)</code>;</dt><dd><p>A topic for messages of type <code>'a</code>.</p></dd></dl><dl><dt class="spec type" id="type-subscription"><a href="#type-subscription" class="anchor"></a><code><span class="keyword">type</span> subscription('a)</code>;</dt><dd><p>A subscription to a topic of type <code>'a</code>.</p></dd></dl><dl><dt class="spec value" id="val-make"><a href="#val-make" class="anchor"></a><code><span class="keyword">let</span> make: unit <span>=&gt;</span> <a href="index.html#type-t">t</a>(<span class="type-var">_</span>);</code></dt><dd><p><code>make()</code> is a new topic. Typically you will create these at a scope that can pass them to any parts of the application that need them.</p></dd></dl><dl><dt class="spec value" id="val-num_subscribers"><a href="#val-num_subscribers" class="anchor"></a><code><span class="keyword">let</span> num_subscribers: <a href="index.html#type-t">t</a>(<span class="type-var">'a</span>) <span>=&gt;</span> Lwt.t(int);</code></dt><dd><p><code>num_subscribers(topic)</code> is a count of the subscribers of the given <code>topic</code>.</p></dd></dl><dl><dt class="spec value" id="val-publish"><a href="#val-publish" class="anchor"></a><code><span class="keyword">let</span> publish: <a href="index.html#type-t">t</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <span>msg:<span class="type-var">'a</span></span> <span>=&gt;</span> Lwt.t(unit);</code></dt><dd><p><code>publish(topic, ~msg)</code> publishes <code>msg</code> onto the <code>topic</code>. This broadcasts the <code>msg</code> to all subscribers of the <code>topic</code>.</p></dd></dl><dl><dt class="spec value" id="val-publish_from"><a href="#val-publish_from" class="anchor"></a><code><span class="keyword">let</span> publish_from: <a href="index.html#type-subscription">subscription</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <span>msg:<span class="type-var">'a</span></span> <span>=&gt;</span> Lwt.t(unit);</code></dt><dd><p><code>publish_from(subscription, ~msg)</code> publishes <code>msg</code> to the topic that <code>subscription</code> subscribes to, ensuring the message is sent to all subscribers <i>except</i> the sender <code>subscription</code>.</p></dd></dl><dl><dt class="spec value" id="val-pull"><a href="#val-pull" class="anchor"></a><code><span class="keyword">let</span> pull: <a href="index.html#type-subscription">subscription</a>(<span class="type-var">'a</span>) <span>=&gt;</span> <span>timeout:float</span> <span>=&gt;</span> Lwt.t(option(<span class="type-var">'a</span>));</code></dt><dd><p><code>pull(subscription, ~timeout)</code> is a message from the topic subscribed to by <code>subscription</code> if there is one within the <code>timeout</code> (in seconds); else <code>None</code>.</p></dd></dl><dl><dt class="spec value" id="val-subscribe"><a href="#val-subscribe" class="anchor"></a><code><span class="keyword">let</span> subscribe: <a href="index.html#type-t">t</a>(<span class="type-var">'a</span>) <span>=&gt;</span> Lwt.t(<a href="index.html#type-subscription">subscription</a>(<span class="type-var">'a</span>));</code></dt><dd><p><code>subscribe(topic)</code> is a subscription to the <code>topic</code>. Note that subscriptions automatically get unsubscribed as soon as the <code>subscription</code> key goes out of scope.</p></dd></dl></div></body></html>